### 요구사항

- Asis Tobe 시스템 검증을 위해 3가지형태의 response 비교 및 일치율 산정을 통한 결과처리
- 이를 확인 할 수 있는 직관적인 UI
- response 유형 3가지
  ```
  1. html (전체 / 부분)
  2. json
  3. String (pipe 구분자)
  ```
  
### 구현 방안

1. 태그단위 전처리 이후 LCS 알고리즘 기반 비교 ( reference : beyound compare)
   - LCS(Longest Common Subsequence) DP로 구현
   - 줄단위비교
   - 비교제외 영역
   - 같은 로직으로 직관적인 UI 구현
2. JsonNode로 파싱, 재귀로 노드 순회 비교
3. | 기준 문자열 분할 및 비교


### 성능개선

- 초기 문제점
  ```
  1. OOM 발생
  2. 비효율적인 전처리
  3. 응답 지연
  ```

- 원인
  ```
  분할 비교가 어려워 수천줄의 HTML을 메모리에 로드
  비교 제외 영역에 관한 처리시 index 변경 및 불필요한 탐색 (제외 영역이 추가될수록 Loof 횟수 증가)
  자체 구현 LCS 알고리즘 성능 한계
  ```

- 개선
  ```
  1.코드개선
  비교제외 영역 전처리 시 Set<Integer>로 index를 저장, 한번의 loof로 제외 영역 저장 O(1)
  Stream API로 일괄 필터, 반복탐색 제거
  불필요한 중간객체 생성 최소화

  2. java-diff-utils 라이브러리 도입
    Patch객체로 변경점을 유형별로 체계적으로 제공하여 정확한 라인별 비교를 ui로 구현하기 좋은 라이브러리라고 판단
    git의 4가지 diff 알고리즘 중 하나임

  3. 순차처리 때문에 단일스레드를 사용하던 로직을 병렬스레드로변경
    순차처리는 로그수집시 로그 생성시점을 통한 로직을 통해 최대한 해결 
  ```
  
- 개선 결과
```
  1. OOM 해결
  2. 초당 3.7 건수행 -> 최대 초당 17건 수행 (로직 중 JSEESSIONID 발급 기능의 수행시간이 변수임을 고려해야 함)
  3. 가독성 개선
```

- 추후 추가 성능개선 사항 및 방안
  ```
  1. diff 라이브러리 교체
    기존 myers 알고리즘 기반 java-diff-utils를 선택한 이유는 정확도 였음
    Histogram알고리즘이 대용량 html에 좀더 적합한지를 고려해야함 (메모리사용량 감소 예상)
    Beyound compare와 유사하도록 개발한 상세 비교 UI 기능도 문제없이 붙일수 있는지 확인해야 함  
  2. 가상스레드 도입 고려 (java21 사용, 가상스레드 가능)
  3. 기존 솔루션 로직상 대부분 Map DTO 사용 -> 필수 및 공통 필드 취합 이후 CLASS DTO로 변경 (record 도입 고려)
  4. 비교 기능 에러 로직 공통화 -> AOP 사용고려 
  ```

